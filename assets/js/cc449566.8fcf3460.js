"use strict";(self.webpackChunkguardian=self.webpackChunkguardian||[]).push([[607],{3905:function(e,t,r){r.d(t,{Zo:function(){return u},kt:function(){return g}});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},u=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(r),g=a,m=p["".concat(l,".").concat(g)]||p[g]||d[g]||i;return r?n.createElement(m,o(o({ref:t},u),{},{components:r})):n.createElement(m,o({ref:t},u))}));function g(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var c=2;c<i;c++)o[c]=r[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}p.displayName="MDXCreateElement"},4140:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return u},default:function(){return p}});var n=r(7462),a=r(3366),i=(r(7294),r(3905)),o=["components"],s={},l="Big Query",c={unversionedId:"providers/bigquery",id:"providers/bigquery",isDocsHomePage:!1,title:"Big Query",description:"BigQuery is an enterprise data warehouse tool for storing and querying massive datasets with super-fast SQL queries using the processing power of Google's infrastructure.",source:"@site/docs/providers/bigquery.md",sourceDirName:"providers",slug:"/providers/bigquery",permalink:"/guardian/docs/providers/bigquery",editUrl:"https://github.com/odpf/guardian/edit/master/docs/docs/providers/bigquery.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Managing appeals",permalink:"/guardian/docs/guides/managing-appeals"},next:{title:"Tableau",permalink:"/guardian/docs/providers/tableau"}},u=[{value:"Authentication",id:"authentication",children:[]},{value:"Access Management",id:"access-management",children:[{value:"BigQuery Resources",id:"bigquery-resources",children:[]},{value:"GCP IAM",id:"gcp-iam",children:[]}]},{value:"1. Config",id:"1-config",children:[{value:"<code>BigQueryCredentials</code>",id:"bigquerycredentials",children:[]},{value:"<code>BigQueryResourceType</code>",id:"bigqueryresourcetype",children:[]},{value:"<code>BigQueryResourcePermission</code>",id:"bigqueryresourcepermission",children:[]}]}],d={toc:u};function p(e){var t=e.components,r=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"big-query"},"Big Query"),(0,i.kt)("p",null,"BigQuery is an enterprise data warehouse tool for storing and querying massive datasets with super-fast SQL queries using the processing power of Google's infrastructure."),(0,i.kt)("p",null,"BigQuery has ",(0,i.kt)("strong",{parentName:"p"},"datasets")," that each one contains multiple ",(0,i.kt)("strong",{parentName:"p"},"tables")," which are used for storing the data. User also can run queries to read or even transform those data."),(0,i.kt)("h2",{id:"authentication"},"Authentication"),(0,i.kt)("p",null,"A service account is required for Guardian to access BigQuery/GCP for fetching resources as well as managing permissions. The service account key is included during the provider registration. Read more on ",(0,i.kt)("a",{parentName:"p",href:"/guardian/docs/guides/managing-providers#registering-provider"},"Registering Provider"),"."),(0,i.kt)("h2",{id:"access-management"},"Access Management"),(0,i.kt)("p",null,"In Guardian, user access can be given at the dataset or table level. To give more flexibility in terms of using BigQuery, Guardian also allow user to get permission at the GCP IAM level."),(0,i.kt)("h3",{id:"bigquery-resources"},"BigQuery Resources"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://cloud.google.com/bigquery/docs/dataset-access-controls"},"Dataset Access Control")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://cloud.google.com/bigquery/docs/table-access-controls-intro"},"Table Access Control"))),(0,i.kt)("h3",{id:"gcp-iam"},"GCP IAM"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://cloud.google.com/iam/docs/granting-changing-revoking-access"},"IAM Permission"))),(0,i.kt)("h2",{id:"1-config"},"1. Config"),(0,i.kt)("h4",{id:"example"},"Example"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'type: google_bigquery\nurn: bg-resource-urn\ncredentials:\n  - service_account_key: <base64 encoded service account key json>\n  - resource_name: projects/gcp-project-id\nappeal:\n  allow_active_access_extension_in: "7d"\nresources:\n  - type: dataset\n    policy:\n      id: bq_dataset_approval\n      version: 1\n    roles:\n      - id: viewer\n        name: Viewer\n        permissions:\n          - READER\n          - roles/bigquery.jobUser\n      - id: editor\n        name: Editor\n        permissions:\n          - WRITER\n  - type: table\n    policy:\n      id: bq_table_approval\n      version: 1\n    roles:\n      - id: viewer\n        name: Viewer\n        permissions:\n          - roles/bigquery.dataViewer\n          - roles/bigquery.jobUser\n')),(0,i.kt)("h3",{id:"bigquerycredentials"},(0,i.kt)("inlineCode",{parentName:"h3"},"BigQueryCredentials")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"string"),". BigQuery credentials is a struct containing ",(0,i.kt)("strong",{parentName:"p"},"base64 encoded")," service account key json and resource name which should be having a ",(0,i.kt)("strong",{parentName:"p"},"projects/")," prefix followed by the gcp project id."),(0,i.kt)("h3",{id:"bigqueryresourcetype"},(0,i.kt)("inlineCode",{parentName:"h3"},"BigQueryResourceType")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"dataset")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"table"))),(0,i.kt)("h3",{id:"bigqueryresourcepermission"},(0,i.kt)("inlineCode",{parentName:"h3"},"BigQueryResourcePermission")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Fields"),(0,i.kt)("th",{parentName:"tr",align:"left"}))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"target")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"string")," Target GCP project ID. If this field presents, the specified role in the ",(0,i.kt)("inlineCode",{parentName:"td"},"name")," field will get applied to this GCP project ID")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"name")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"string")," Required. GCP role name ",(0,i.kt)("strong",{parentName:"td"},"Note:")," for ",(0,i.kt)("inlineCode",{parentName:"td"},"dataset")," resource type, we are using legacy roles ","(",(0,i.kt)("inlineCode",{parentName:"td"},"READER"),", ",(0,i.kt)("inlineCode",{parentName:"td"},"WRITER"),", or ",(0,i.kt)("inlineCode",{parentName:"td"},"OWNER"),")",". ",(0,i.kt)("a",{parentName:"td",href:"https://cloud.google.com/bigquery/docs/reference/rest/v2/datasets#:~:text=Required.%20An%20IAM,back%20as%20%22OWNER%22."},"Read more..."))))))}p.isMDXComponent=!0}}]);